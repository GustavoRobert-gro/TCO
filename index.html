<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerar PDF</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>

    <form id="formDados">

        
        <label for="numero_tco">Nº TCO:</label>
        <input type="text" id="numero_tco" required><br>

        <label for="dia">Dia:</label>
        <input type="text" id="dia" required><br>

        <label for="mes">Mês:</label>
        <input type="text" id="mes" required><br>

        <label for="ano">Ano:</label>
        <input type="text" id="ano" required><br>

        <label for="cidade">Cidade:</label>
        <input type="text" id="cidade" required><br>

        <label for="quartel">Quartel:</label>
        <input type="text" id="quartel" required><br>

        <label for="nome_completo">Nome Completo:</label>
        <input type="text" id="nome_completo" required><br>

        <label for="posto_grad">Posto/Grad:</label>
        <input type="text" id="posto_grad" required><br>

        <label for="rg">RG:</label>
        <input type="text" id="rg" required><br>

        <button type="button" onclick="gerarPDF()">Gerar PDF</button>
    </form>

    <script>
        const numerosPorExtenso = {
            1: 'um', 2: 'dois', 3: 'três', 4: 'quatro', 5: 'cinco', 6: 'seis', 7: 'sete', 8: 'oito', 9: 'nove',
            10: 'dez', 11: 'onze', 12: 'doze', 13: 'treze', 14: 'quatorze', 15: 'quinze', 16: 'dezesseis',
            17: 'dezessete', 18: 'dezoito', 19: 'dezenove', 20: 'vinte', 21: 'vinte e um', 22: 'vinte e dois',
            23: 'vinte e três', 24: 'vinte e quatro', 25: 'vinte e cinco', 26: 'vinte e seis', 27: 'vinte e sete',
            28: 'vinte e oito', 29: 'vinte e nove', 30: 'trinta', 31: 'trinta e um'
        };

        const mesesPorExtenso = {
            1: 'janeiro', 2: 'fevereiro', 3: 'março', 4: 'abril', 5: 'maio', 6: 'junho', 7: 'julho', 8: 'agosto',
            9: 'setembro', 10: 'outubro', 11: 'novembro', 12: 'dezembro'
        };

        function converterAnoParaExtenso(ano) {
            return ano.split('').map(num => numerosPorExtenso[parseInt(num)]).join(' ');
        }

        function gerarPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            const dia = parseInt(document.getElementById('dia').value);
            const mes = parseInt(document.getElementById('mes').value);
            const ano = document.getElementById('ano').value;
            const cidade = document.getElementById('cidade').value;
            const quartel = document.getElementById('quartel').value;
            const nome_completo = document.getElementById('nome_completo').value;
            const posto_grad = document.getElementById('posto_grad').value;
            const rg = document.getElementById('rg').value;

            const img = new Image();
            img.src = 'https://upload.wikimedia.org/wikipedia/commons/7/7f/Bras%C3%A3o_PMMT.PNG';

            img.onload = function () {
                doc.addImage(img, 'PNG', 90, 5, 20, 20);

                doc.setFont("helvetica", "bold");
                doc.setFontSize(10);
                doc.text("ESTADO DE MATO GROSSO", 105, 30, { align: "center" });
                doc.text("POLÍCIA MILITAR", 105, 35, { align: "center" });

                let numeroTCO = "TCO/CR07/2025.0038";
                doc.text("TERMO CIRCUNSTANCIADO DE OCORRÊNCIA Nº " + numeroTCO, 105, 42, { align: "center" });

                const diaExtenso = numerosPorExtenso[dia];
                const mesExtenso = mesesPorExtenso[mes];
                const anoExtenso = converterAnoParaExtenso(ano);

                doc.setFontSize(14);
                doc.text("AUTUAÇÃO", 105, 100, { align: "center" });
doc.setFont("helvetica", "normal");
                doc.setFontSize(12);

                let texto = `Aos ${diaExtenso} dias do mês de ${mesExtenso} do ano de ${anoExtenso}, nesta cidade de ${cidade}, Estado de Mato Grosso, no Quartel do ${quartel}, autuo as peças que adiante se seguem, do que para constar, lavrei este Termo. Eu, ${nome_completo} (${posto_grad}), escrevente, que o lavrei e assino.`;

                doc.text(texto, 20, 120, {
                    maxWidth: 170,
                    align: 'justify',
                });

                doc.setFontSize(8);
                doc.text("_______________________________________________________________________________________________________________", 105, 281, { align: "center" });
                doc.text("NUCLEO DE POLICIA MILITAR DE DENISE", 105, 285, { align: "center" });
                doc.text("Rua Piaui - Bairro centro - Denise-MT - CEP 78.380-000", 105, 288, { align: "center" });
                doc.text("Fone: (65) 98170 0447 | E-mail: npmdenise@pm.mt.gov.br", 105, 291, { align: "center" });

                doc.save("documento.pdf");
            };

            img.onerror = function () {
                alert("Erro ao carregar a imagem. Verifique a URL.");
            };
        }
    </script>
</body>
</html>
