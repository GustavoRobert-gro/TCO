<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TCO - Cadastro</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container mt-4">
    <h1>Cadastro de TCO</h1>
    <hr>

    <!-- Formulário Dados Gerais -->
    <h2>1º Dados Gerais</h2>
    <form id="formDadosGerais">
        <label for="numero_tco">Nº TCO:</label>
        <input type="text" id="numero_tco" value="0038" required style="width: 60px";>

        
        
        <label for="artigo">Artigo:</label>
        <input type="text" id="artigo" value="" required style="width: 250px";>

        <label for="naturezaa">Naturezaa:</label>
        <input type="text" id="naturezaa" value="Lesão corporal Leve" required style="width: 660px";>

        </div>
       
        <div class="date-group">

            <label for="cidade">Cidade:</label>
        <select id="cidade" required style="width: 120px";>
            <option value="Denise-MT">Denise-MT</option>
            <option value="Barra do Bugres-MT">Barra do Bugres-MT</option>
            <option value="Nova Olimpia-MT">Nova Olimpia-MT</option>
            <option value="Porto Estrela-MT">Porto Estrela-MT</option>
            </select>

            <label for="dia">Dia:</label>
            <input type="text" id="dia" value= "26" required>
            
            <label for="mes">Mês:</label>
            <input type="text" id="mes" value="02" required>
            
            <label for="ano">Ano:</label>
            <input type="text" id="ano" value="2025" required>
        
            <label for="data_registro">Data do Registro:</label>
            <input type="date" id="data_registro" required>

            <script>
                // Obter a data atual no formato YYYY-MM-DD
                const today = new Date().toISOString().split('T')[0];
                
                // Definir o valor do campo como a data atual
                document.getElementById('data_registro').value = today;
            </script>

        
    
            <label for="hora_fato">Hr Fato:</label>
            <input type="text" id="hora_fato" value="00h00min" required>

        <label for="quartel">Quartel:</label>
        <select id="quartel" required>
            <option value="NPM DENISE">Nucleo de policia Militar de Denise - MT</option>
            <option value="12ª CIPM">12ª CIPM de Barra do Bugres - MT</option>
            <option value="1ª CIPM">1ª CIPM de Nova Olimpia - MT</option>
            <option value="NPM PORTO ESTRELA">Nucleo de Policia Militar de Porto Estrela-MT</option>
            </select>
    
        </div>

        <div class="date-group">
        <label for="nome_completo">Nome Completo do condutor:</label>
<select id="nome_completo" required>
<option value="GUSTAVO ROBERT DE OLIVEIRA">Gustavo Robert de Oliveira</option>
<option value="JOÃO SILVA">JOÃO SILVA</option>
<option value="MARIA FERREIRA">MARIA FERREIRA</option>
<option value="ANTONIO SOUZA">ANTONIO SOUZA</option>
</select>
        

        <label for="posto_grad">Posto/Grad:</label>
        <select id="posto_grad" required>
            <option value="CEL-PMMT">CEL-PMMT</option>
            <option value="TEN Cel-PMMT">TEN Cel-PMMT</option>
            <option value="MAJOR-PMMT">MAJOR-PMMT</option>
            <option value="CAP-PMMT">CAP-PMMT</option>
            <option value="TEN-PMMT">TEN-PMMT</option>
            <option value="SUB TEN-PMMT">SUB TEN-PMMT</option>
            <option value="1º SGT-PMMT">1º SGT-PMMT</option>
            <option value="2º SGT-PMMT">2º SGT-PMMT</option>
            <option value="3º SGT-PMMT">3º SGT-PMMT</option>
            <option value="CB-PMMT">CB-PMMT</option>
            <option value="SD-PMMT">SD-PMMT</option>
        
        </select>

        <label for="rg">RGPM:</label>
        <input type="text" id="rg" value="885.812" required style="width: 60px";>

        
        
        
        <label for="cep">CEP:</label>
        <input type="text" id="cep" value="78.380-000" required style="width: 90px";>


        <label for="comunicante">COMUNICANTE:</label>
        <input type="text" id="comunicante" value="" required>

        </div>

        
        <div class="date-group">

        <label for="endereco">ENDEREÇO:</label>
        <input type="text" id="endereco" value="endereço do local do fato" required>
        <label for="local_fato">LOCAL DO FATO:</label>
        <input type="text" id="local_fato" value="AVENIDA JULIO CAMPOS" required>

        <label for="ponto_referencia">PONTO DE REFERRÊNCIA:</label>
        <input type="text" id="ponto_referencia" value="Proximo do que ?" required>
        
        </div>

        <hr>

    </form>
    <hr>





    <!-- Cadastro de Autor -->
    <h2>2º Cadastro de Autor do Fato</h2>
    <form id="formAutor">
        <div id="pessoasAutor"></div>
        <button type="button" class="btn btn-primary mt-3" onclick="adicionarPessoa('Autor')">Adicionar Autor</button>
    </form>
    <hr>

    <!-- Cadastro de Vítima -->
    <h2>3º Cadastro de Vítima / Testemunha</h2>
    <form id="formVitima">
        <div id="pessoasVitima"></div>
        <button type="button" class="btn btn-primary mt-3" onclick="adicionarPessoa('Vitima')">Adicionar Vítima</button>
        <button type="button" class="btn btn-primary mt-3" onclick="adicionarPessoa('Testemunha')">Adicionar Testemunha</button>
    <hr>



    

    <button type="button" class="btn btn-success mt-3" onclick="gerarPDF()">Gerar PDF Completo</button>

    <script>
        let contadorAutor = 1;
        let contadorVitima = 1;
        let contadorTestemunha = 1;

        function adicionarPessoa(tipo) {
            const container = tipo === 'Autor' ? document.getElementById('pessoasAutor') : document.getElementById('pessoasVitima') ; 
            document.getElementById("testemunha") ;

            const contador = tipo === 'Autor' ? contadorAutor++ : contadorVitima++ ; contadorTestemunha++ ;

            const divPessoa = document.createElement('div');
            divPessoa.classList.add('pessoa', 'border', 'p-3', 'mb-3');
            divPessoa.innerHTML = `
                <h4>${tipo} ${contador}</h4>
                <label>Nome</label>
                <input type="text" class="form-control" name="nome_${tipo.toLowerCase()}[]" placeholder="Digite o nome">
                
                <label>Nome Social</label>
                <input type="text" class="form-control" name="nome_social_${tipo.toLowerCase()}[]" placeholder="Digite o nomeSocial">
                
                <label>Cpf ou Passaporte</label>
                <input type="text" class="form-control" name="cpf_passaporte_${tipo.toLowerCase()}[]" placeholder="Digite o CPF ou Passaporte">
               
                <label>RG/CNH Nº</label>
                <input type="text" class="form-control" name="rg_cnh_${tipo.toLowerCase()}[]" placeholder="Digite o RG ou CNH">

                <label>ÓRGÃO EXPEDITOR</label>
                <input type="text" class="form-control" name="rg_cnh_orgao_exp_${tipo.toLowerCase()}[]" placeholder="Digite o orgão expeditor">
                
                <label>DATA DE EXPEDIÇÃO</label>
                <input type="text" class="form-control" name="data_expedicao_${tipo.toLowerCase()}[]" placeholder="Digite a data de expedição">

               <label>UF</label>
                <input type="text" class="form-control" name="data_expedicao_uf_${tipo.toLowerCase()}[]" placeholder="Digite o estado de expedição do documento">

                <label>FILIAÇÃO</label>
                <input type="text" class="form-control" name="filiacao_${tipo.toLowerCase()}[]" placeholder="Digite a filiação">

                <label>ENDEREÇO</label>
                <input type="text" class="form-control" name="endereco_${tipo.toLowerCase()}[]" placeholder="Digite o endereço">

                <label>MUNICIPIO</label>
                <input type="text" class="form-control" name="municipio_${tipo.toLowerCase()}[]" value="DENISE">

                <label>UF</label>
                <input type="text" class="form-control" name="uf_municipio_${tipo.toLowerCase()}[]" value="MT">

                <label>CEP</label>
                <input type="text" class="form-control" name="cep_municipio_${tipo.toLowerCase()}[]" value="78.380-000">
               
                <button type="button" class="btn btn-danger mt-2" onclick="removerPessoa(this)">Remover</button>`;

            container.appendChild(divPessoa);
        }

        function removerPessoa(botao) {
            botao.parentElement.remove();
        }

        function gerarPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            const numero_tco = parseInt(document.getElementById('numero_tco').value);
            const naturezaa = document.getElementById('naturezaa').value;
            const artigo = document.getElementById("artigo").value
            const dia = parseInt(document.getElementById('dia').value);
            const mes = parseInt(document.getElementById('mes').value);
            const ano = document.getElementById('ano').value;
            const cidade = document.getElementById('cidade').value;
            const quartel = document.getElementById('quartel').value;
            const nome_completo = document.getElementById('nome_completo').value;
            const posto_grad = document.getElementById('posto_grad').value;
            const rg = document.getElementById('rg').value;
            const hora_fato = document.getElementById('hora_fato').value;
            //const data_fato = document.getElementById('data_fato').value;
            const data_registro = document.getElementById('data_registro').value;
            const endereco = document.getElementById('endereco').value;
            const comunicante = document.getElementById('comunicante').value;
            const ponto_referencia = document.getElementById('ponto_referencia').value;
            const cep = document.getElementById("cep").value;


            const numerosPorExtenso = {
            1: 'um', 2: 'dois', 3: 'três', 4: 'quatro', 5: 'cinco', 6: 'seis', 7: 'sete', 8: 'oito', 9: 'nove',
            10: 'dez', 11: 'onze', 12: 'doze', 13: 'treze', 14: 'quatorze', 15: 'quinze', 16: 'dezesseis',
            17: 'dezessete', 18: 'dezoito', 19: 'dezenove', 20: 'vinte', 21: 'vinte e um', 22: 'vinte e dois',
            23: 'vinte e três', 24: 'vinte e quatro', 25: 'vinte e cinco', 26: 'vinte e seis', 27: 'vinte e sete',
            28: 'vinte e oito', 29: 'vinte e nove', 30: 'trinta', 31: 'trinta e um'
        };

        const mesesPorExtenso = {
            1: 'janeiro', 2: 'fevereiro', 3: 'março', 4: 'abril', 5: 'maio', 6: 'junho', 7: 'julho', 8: 'agosto',
            9: 'setembro', 10: 'outubro', 11: 'novembro', 12: 'dezembro'
        };

        function converterAnoParaExtenso(ano) {
            return ano.split('').map(num => numerosPorExtenso[parseInt(num)]).join(' ');
        }



           

            function adicionarCabecalho() {
                const img = new Image();
            img.src = 'https://upload.wikimedia.org/wikipedia/commons/7/7f/Bras%C3%A3o_PMMT.PNG';
            doc.addImage(img, 'PNG', 93, 5, 20, 20);
            doc.setFont("helvetica", "bold");
            doc.setFontSize(10);
            doc.text("ESTADO DE MATO GROSSO", 103, 30, { align: "center" });
            doc.text("POLÍCIA MILITAR", 103, 35, { align: "center" });
            doc.text("TERMO CIRCUNSTANCIADO DE OCORRÊNCIA Nº TCO/CR07/" +"/"+document.getElementById('ano').value+"."+ parseInt(document.getElementById('numero_tco').value), 103, 47, { align: "center" });
            
                doc.line(10, 38, 200, 38);
            }

            function adicionarRodape() {
            doc.setFontSize(8);
            doc.text("_______________________________________________________________________________________________________________", 105, 281, { align: "center" });
            doc.text("NUCLEO DE POLICIA MILITAR DE DENISE", 105, 285, { align: "center" });
            doc.text("Rua Piaui - Bairro centro - Denise-MT - CEP 78.380-000", 105, 288, { align: "center" });
            doc.text("Fone: (65) 98170 0447 | E-mail: npmdenise@pm.mt.gov.br", 105, 291, { align: "center" });
        }

            adicionarCabecalho();
            adicionarRodape()
            doc.setFontSize(12);

            
           // doc.text("teste numero de tco",10, y)

            doc.text("AUTUAÇÃO", 105, 100, { align: "center" });

const diaExtenso = numerosPorExtenso[dia];
  const mesExtenso = mesesPorExtenso[mes];
const anoExtenso = converterAnoParaExtenso(ano);


let texto = `Aos ${diaExtenso} dias do mês de ${mesExtenso} do ano de ${anoExtenso}, nesta cidade de ${cidade}, Estado de Mato Grosso, no Quartel do ${quartel}, autuo as peças que adiante se seguem, do que para constar, lavrei este Termo. Eu, ${nome_completo} (${posto_grad}), escrevente, que o lavrei e assino.`;


doc.setFont("helvetica", "normal");
doc.text(texto, 20, 120, { maxWidth: 175, align: 'justify'});


doc.setFont("helvetica", "bold");
let texto2 =` ${nome_completo} - ${posto_grad} `;
doc.text(texto2, 103, 200,{ align: "center" });

let texto3 = `RG nº ${rg} PMMT`;
doc.text(texto3, 103, 206,{ align: "center" });








            doc.addPage();
            adicionarRodape()
            adicionarCabecalho()


        let y2 = 20; // Posição inicial na página
       const limitePagina = 270; // Altura máxima antes de adicionar nova página


            
            let y = 60;
            doc.text("AUTOR DO FATO:", 30, y);
            y += 10;




            document.getElementsByName("nome_autor[]").forEach((input, index) => {
    const nomeAutor = input.value;
    const nomeSocial = document.getElementsByName("nome_social_autor[]")[index]?.value || "N/A"; // Se não houver nome social, exibe "N/A"
    const cpfAutor = document.getElementsByName("cpf_passaporte_autor[]")[index]?.value || "N/A"; // Se não houver nome social, exibe "N/A"
    const rgcnhAutor = document.getElementsByName("rg_cnh_autor[]")[index]?.value || "N/A"; // Se não houver nome social, exibe "N/A"
    const rgcnhorgaoexpAutor = document.getElementsByName("rg_cnh_orgao_exp_autor[]")[index]?.value || "N/A"; // Se não houver nome social, exibe "N/A"
    const dataexpedicaoAutor = document.getElementsByName("data_expedicao_autor[]")[index]?.value || "N/A"; // Se não houver nome social, exibe "N/A"
    const dataexpedicaoufAutor = document.getElementsByName("data_expedicao_uf_autor[]")[index]?.value || "N/A"; // Se não houver nome social, exibe "N/A"
    const filiacaoAutor = document.getElementsByName("filiacao_autor[]")[index]?.value || "N/A"; // Se não houver nome social, exibe "N/A"
    const enderecoAutor = document.getElementsByName("endereco_autor[]")[index]?.value || "N/A"; // Se não houver nome social, exibe "N/A"
    const municipioAutor = document.getElementsByName("municipio_autor[]")[index]?.value || "N/A"; // Se não houver nome social, exibe "N/A"
    const ufmunicipioAutor = document.getElementsByName("uf_municipio_autor[]")[index]?.value || "N/A"; // Se não houver nome social, exibe "N/A"
    const cepmunicipioAutor = document.getElementsByName("cep_municipio_autor[]")[index]?.value || "N/A"; // Se não houver nome social, exibe "N/A"



    doc.setFontSize(8);
    doc.text(`${index + 1}. NOME: ${nomeAutor}`, 20, y);
    y += 6;
    doc.text(`   NOME SOCIAL: ${nomeSocial}`, 20, y);
    y += 6;
    doc.text(`   CPF: ${cpfAutor}`, 20, y);
    y += 6;
    doc.text(`   RG/CNH: ${rgcnhAutor}`, 20, y);
    
    doc.text(`   ORGÃO EXPEDITOR: ${rgcnhorgaoexpAutor}`, 120, y);
    y += 6;
    doc.text(`   DATA DE EXPEDIÇÃO: ${dataexpedicaoAutor}`, 20, y);
    doc.text(`   UF: ${dataexpedicaoAutor}`, 120, y);
    y += 6;
    doc.text(`   FILIAÇÃO: ${filiacaoAutor}`, 20, y);
    y += 6;
    doc.text(`   ENDEREÇO: ${enderecoAutor}`, 20, y);
    y += 6;
    doc.text(`   MUNICIPIO: ${municipioAutor}`, 20, y);
    doc.text(`   UF: ${ufmunicipioAutor}`, 120, y);
    doc.text(`   CEP: ${cepmunicipioAutor}`, 140, y);

});


            
            document.getElementsByName("nome_vitima[]").forEach((input, index) => {
                if (y > 270) {
            doc.addPage(); // Cria uma nova página
            adicionarCabecalho()
            adicionarRodape()
            y = 60; // Reinicia a posição no topo da nova página
            doc.text(`${index + 1}. ${input.value}`, 10, y);
                }
                
                doc.text(`${index + 1}. ${input.value}`, 10, y);
                y += 7;
            });

            



            y += 10;
            doc.text("Testemuna:", 10, y);
            y += 10;
            
            document.getElementsByName("nome_testemunha[]").forEach((input, index) => {
                if (y > 270) {
            doc.addPage(); // Cria uma nova página
            adicionarCabecalho()
            adicionarRodape()
            y = 60; // Reinicia a posição no topo da nova página
            doc.text(`${index + 1}. ${input.value}`, 10, y);
                }
                
                doc.text(`${index + 1}. ${input.value}`, 10, y);
                y += 7;
            });



            doc.save("tco.pdf");
        }
    </script>
</body>
</html>
