<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TCO</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
        }
        form {
            display: flex;
            flex-direction: column;
        }
        label {
            font-weight: bold;
            margin-top: 10px;
        }
        input {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            border-radius: 5px;
            border: 1px solid #ccc;
            font-size: 16px;
        }
        .date-group {
            display: flex;
            justify-content: space-between;
        }
        .date-group input {
            width: 32%;
        }
        button {
            margin-top: 15px;
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>

    

    
    <div class="container">
        <h1>TCO</h1>
        <form id="formDados">
            <hr>
            <hr>
            <hr>
            
            <label for="conteudo">Sistema de confecção de TCO - Em desenvolvimento...</label>
            
            


            
            <div class="date-group">
            <label for="numero_tco">Nº TCO:</label>
            <input type="text" id="numero_tco" value="0038" required class="width: 10px">
            
            <label for="artigo">Artigo:</label>
            <input type="text" id="artigo" value="" required class="width: 10px">

            <label for="naturezaa">Naturezaa:</label>
            <input type="text" id="naturezaa" value="Lesão corporal Leve" required>

            </div>
           
            <div class="date-group">
                <label for="dia">Dia:</label>
                <input type="text" id="dia" value= "26" required>
                
                <label for="mes">Mês:</label>
                <input type="text" id="mes" value="02" required>
                
                <label for="ano">Ano:</label>
                <input type="text" id="ano" value="2025" required>
            
           

           
            <label for="cidade">Cidade:</label>
            <select id="cidade" required>
                <option value="Denise-MT">Denise-MT</option>
                <option value="Barra do Bugres-MT">Barra do Bugres-MT</option>
                <option value="Nova Olimpia-MT">Nova Olimpia-MT</option>
                <option value="Porto Estrela-MT">Porto Estrela-MT</option>
                </select>
        

            <label for="quartel">Quartel:</label>
            <select id="quartel" required>
                <option value="NPM DENISE">Nucleo de policia Militar de Denise - MT</option>
                <option value="12ª CIPM">12ª CIPM de Barra do Bugres - MT</option>
                <option value="1ª CIPM">1ª CIPM de Nova Olimpia - MT</option>
                <option value="NPM PORTO ESTRELA">Nucleo de Policia Militar de Porto Estrela-MT</option>
                </select>
        
            </div>

            <div class="date-group">
            <label for="nome_completo">Nome Completo do condutor:</label>
<select id="nome_completo" required>
    <option value="GUSTAVO ROBERT DE OLIVEIRA">Gustavo Robert de Oliveira</option>
    <option value="JOÃO SILVA">JOÃO SILVA</option>
    <option value="MARIA FERREIRA">MARIA FERREIRA</option>
    <option value="ANTONIO SOUZA">ANTONIO SOUZA</option>
</select>
            

            <label for="posto_grad">Posto/Grad:</label>
            <select id="posto_grad" required>
                <option value="CEL-PMMT">CEL-PMMT</option>
                <option value="TEN Cel-PMMT">TEN Cel-PMMT</option>
                <option value="MAJOR-PMMT">MAJOR-PMMT</option>
                <option value="CAP-PMMT">CAP-PMMT</option>
                <option value="TEN-PMMT">TEN-PMMT</option>
                <option value="SUB TEN-PMMT">SUB TEN-PMMT</option>
                <option value="1º SGT-PMMT">1º SGT-PMMT</option>
                <option value="2º SGT-PMMT">2º SGT-PMMT</option>
                <option value="3º SGT-PMMT">3º SGT-PMMT</option>
                <option value="CB-PMMT">CB-PMMT</option>
                <option value="SD-PMMT">SD-PMMT</option>
            
            </select>

            <label for="rg">RGPM:</label>
            <input type="text" id="rg" value="885.812" required>

        </div>

            <button type="button" onclick="gerarPDF()">Gerar PDF</button>
        </form>
    </div>
    <script>


        const numerosPorExtenso = {
            1: 'um', 2: 'dois', 3: 'três', 4: 'quatro', 5: 'cinco', 6: 'seis', 7: 'sete', 8: 'oito', 9: 'nove',
            10: 'dez', 11: 'onze', 12: 'doze', 13: 'treze', 14: 'quatorze', 15: 'quinze', 16: 'dezesseis',
            17: 'dezessete', 18: 'dezoito', 19: 'dezenove', 20: 'vinte', 21: 'vinte e um', 22: 'vinte e dois',
            23: 'vinte e três', 24: 'vinte e quatro', 25: 'vinte e cinco', 26: 'vinte e seis', 27: 'vinte e sete',
            28: 'vinte e oito', 29: 'vinte e nove', 30: 'trinta', 31: 'trinta e um'
        };

        const mesesPorExtenso = {
            1: 'janeiro', 2: 'fevereiro', 3: 'março', 4: 'abril', 5: 'maio', 6: 'junho', 7: 'julho', 8: 'agosto',
            9: 'setembro', 10: 'outubro', 11: 'novembro', 12: 'dezembro'
        };

        function converterAnoParaExtenso(ano) {
            return ano.split('').map(num => numerosPorExtenso[parseInt(num)]).join(' ');
        }


        





        function adicionarCabecalho(doc, paginaAtual) {
            const img = new Image();
            img.src = 'https://upload.wikimedia.org/wikipedia/commons/7/7f/Bras%C3%A3o_PMMT.PNG';
            doc.addImage(img, 'PNG', 93, 5, 20, 20);
            doc.setFont("helvetica", "bold");
            doc.setFontSize(10);
            doc.text("ESTADO DE MATO GROSSO", 103, 30, { align: "center" });
            doc.text("POLÍCIA MILITAR", 103, 35, { align: "center" });
            
            
            doc.text("TERMO CIRCUNSTANCIADO DE OCORRÊNCIA Nº TCO/CR07/"+ document.getElementById('quartel').value +"/"+document.getElementById('ano').value+"."+ parseInt(document.getElementById('numero_tco').value), 103, 45, { align: "center" });
            

            
        }
        
        function adicionarRodape(doc) {
            doc.setFontSize(8);
            doc.text("_______________________________________________________________________________________________________________", 105, 281, { align: "center" });
            doc.text("NUCLEO DE POLICIA MILITAR DE DENISE", 105, 285, { align: "center" });
            doc.text("Rua Piaui - Bairro centro - Denise-MT - CEP 78.380-000", 105, 288, { align: "center" });
            doc.text("Fone: (65) 98170 0447 | E-mail: npmdenise@pm.mt.gov.br", 105, 291, { align: "center" });
        }

        
        
        function gerarPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            const numero_tco = parseInt(document.getElementById('numero_tco').value);
            const naturezaa = document.getElementById('naturezaa').value;
            const dia = parseInt(document.getElementById('dia').value);
            const mes = parseInt(document.getElementById('mes').value);
            const ano = document.getElementById('ano').value;
            const cidade = document.getElementById('cidade').value;
            const quartel = document.getElementById('quartel').value;
            const nome_completo = document.getElementById('nome_completo').value;
            const posto_grad = document.getElementById('posto_grad').value;
            const rg = document.getElementById('rg').value;




// primeira pagina
            let paginaAtual = 0;
            adicionarCabecalho(doc,"");
            doc.setFont("Times New Roman", "normal");
            doc.setFontSize(12);
            
            //let conteudo = document.getElementById("conteudo").value;
            //doc.text(conteudo, 20, 50, { maxWidth: 170, align: 'justify' });
            
            doc.text("AUTUAÇÃO", 105, 100, { align: "center" });

            const diaExtenso = numerosPorExtenso[dia];
                const mesExtenso = mesesPorExtenso[mes];
                const anoExtenso = converterAnoParaExtenso(ano);
        

            let texto = `Aos ${diaExtenso} dias do mês de ${mesExtenso} do ano de ${anoExtenso}, nesta cidade de ${cidade}, Estado de Mato Grosso, no Quartel do ${quartel}, autuo as peças que adiante se seguem, do que para constar, lavrei este Termo. Eu, ${nome_completo} (${posto_grad}), escrevente, que o lavrei e assino.`;

                

             doc.text(texto, 20, 120, { maxWidth: 175, align: 'justify'});

             let texto2 =` ${nome_completo} - ${posto_grad} `;
            doc.text(texto2, 103, 200,{ align: "center" });

            let texto3 = `RG nº ${rg} PMMT`;
            doc.text(texto3, 103, 206,{ align: "center" });


            adicionarRodape(doc);
            
           // fim da primeira pagina
           
           // inicio da segunda pagina
            doc.addPage();
            paginaAtual++;
            adicionarCabecalho(doc, paginaAtual);
            doc.text(`Página ${paginaAtual++}`, 180, 10);
            doc.text("Aqui começa o conteúdo da página 2...", 20, 50, { maxWidth: 170, align: 'justify' });
            adicionarRodape(doc);
            
            // fim da segundapagina
            

            // inicio da terceira pagina
            doc.addPage();
            paginaAtual+1;
            adicionarCabecalho(doc, paginaAtual);
            doc.text(`Página ${paginaAtual++}`, 180, 10);
            doc.text("Aqui começa o conteúdo da página 2...", 20, 50, { maxWidth: 170, align: 'justify' });
            adicionarRodape(doc);

            // fim da terceira paginA

            doc.save("documento.pdf");
        }
    </script>
</body>
</html>
